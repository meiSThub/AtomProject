1、addInterceptor与addNetworkInterceptor的区别

二者通常的叫法为应用拦截器和网络拦截器，从整个责任链路来看，应用拦截器是最先执行的拦截器，也就是用户自己设置request属性后的原始请求，而网络拦截器位于ConnectInterceptor和CallServerInterceptor之间，此时网络链路已经准备好，只等待发送请求数据。

1. 首先，应用拦截器在RetryAndFollowUpInterceptor和CacheInterceptor之前，所以一旦发生错误重试或者网络重定向，网络拦截器可能执行多次，因为相当于进行了二次请求，但是应用拦截器永远只会触发一次。另外如果在CacheInterceptor中命中了缓存就不需要走网络请求了，因此会存在短路网络拦截器的情况。
2. 其次，如上文提到除了CallServerInterceptor，每个拦截器都应该至少调用一次realChain.proceed方法。实际上在应用拦截器这层可以多次调用proceed方法（本地异常重试）或者不调用proceed方法（中断），但是网络拦截器这层连接已经准备好，可且仅可调用一次proceed方法。
3. 最后，从使用场景看，应用拦截器因为只会调用一次，通常用于统计客户端的网络请求发起情况；而网络拦截器一次调用代表了一定会发起一次网络通信，因此通常可用于统计网络链路上传输的数据。

2、OkHttp 的整体流程

构建请求，并执行请求任务，如果正在执行的任务数没有超过最大任务数，则把任务放入正在执行任务列表中，并通过线程池执行该任务，如果超过最大任务数，则把任务放入等待任务列表中。

在连接池中查找是否有相同域名和端口号的可用连接（连接没有关闭），如果有找到则直接复用，如果没有找到则创建一个新的连接，解析域名和端口号，通过Socket建立连接，获得输入流和输出流(TCP + TLS 握手)。

把请求头和请求体通过 输出流 传给服务端，通过输入流读取服务器响应数据，读取相应头和响应体数据，判断是否可以保持长连接，如果不允许则关闭连接，读取相应体数据，并封装成对应的数据如字符串。

